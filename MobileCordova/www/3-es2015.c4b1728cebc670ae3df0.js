(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"H+bZ":function(t,i,n){"use strict";n.d(i,"a",(function(){return u}));var e=n("HDdC"),o=n("7o/Q");function s(t=-1){return i=>i.lift(new c(t,i))}class c{constructor(t,i){this.count=t,this.source=i}call(t,i){return i.subscribe(new r(t,this.count,this.source))}}class r extends o.a{constructor(t,i,n){super(t),this.count=i,this.source=n}error(t){if(!this.isStopped){const{source:i,count:n}=this;if(0===n)return super.error(t);n>-1&&(this.count=n-1),i.subscribe(this._unsubscribeAndRecycle())}}}var a=n("JIr8"),b=n("fXoL"),l=n("tk/3");let u=(()=>{class t{constructor(t){this.http=t,this.endpoint="http://2.238.108.96:3000",this.clientEndpoint="http://ammireto.cloud"}handleError(t){return t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error(`Backend returned code ${t.status}, body was: `+t.error),new e.a(t=>t.error("Something bad happened; please try again later."))}getCardSets(){return this.http.get(this.endpoint+"/getCardSets").pipe(s(2),Object(a.a)(this.handleError))}getGames(){return this.http.get(this.endpoint+"/getGames").pipe(s(2),Object(a.a)(this.handleError))}createGroup(t,i,n,e){return this.http.post(this.endpoint+"/createGroup",{nickname:t,cardSet:i,game:n,money:e}).pipe(s(2),Object(a.a)(this.handleError))}joinGroup(t,i){return this.http.get(this.endpoint+"/joinGroup/"+t+"/"+i).pipe(s(2),Object(a.a)(this.handleError))}exitGroup(t,i){return this.http.get(this.endpoint+"/exitGroup/"+t+"/"+i).pipe(s(2),Object(a.a)(this.handleError))}updatePlayers(t,i){return this.http.post(this.endpoint+"/updatePlayers",{players:t,code:i}).pipe(s(2),Object(a.a)(this.handleError))}updateBalance(t,i,n){return this.http.get(this.endpoint+"/updateBalance/"+t+"/"+i+"/"+n).pipe(s(2),Object(a.a)(this.handleError))}setGhost(t,i,n){return this.http.get(this.endpoint+"/setGhost/"+t+"/"+i+"/"+n).pipe(s(2),Object(a.a)(this.handleError))}}return t.\u0275fac=function(i){return new(i||t)(b.Qb(l.a))},t.\u0275prov=b.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},HM5V:function(t,i,n){"use strict";n.d(i,"a",(function(){return e})),n.d(i,"b",(function(){return o}));var e=function(t){return t.Close="close-outline",t.Login="log-in-outline",t.Logout="log-out-outline",t.Info="alert-circle-outline",t}({});class o{constructor(){this.disableButton=!1,this.time=2e3}}},OC8m:function(t,i,n){"use strict";n.d(i,"a",(function(){return a}));var e=n("mrSG"),o=n("2Vo4"),s=n("HM5V"),c=n("fXoL"),r=n("TEn/");let a=(()=>{class t{constructor(t){this.toastController=t,this.notifications=[],this.notificationListener=new o.a(this.notifications),this.queue=-1,this.initialized=!1}ionViewDidLeave(){this.disableNotifications()}addNotification(t,i,n,e){const o=new s.b;o.message=t,o.icon=null!=i?i:o.icon,o.time=null!=n?n:o.time,o.disableButton=null!=e?e:o.disableButton,this.notifications.push(o),this.notificationListener.next(this.notifications)}enableNotifications(){this.initialized||(this.initialized=!0,this.notificationListener.subscribe(t=>Object(e.a)(this,void 0,void 0,(function*(){if(0!=t.length){const t=this.notifications.pop();this.notificationListener.next(this.notifications),yield this.showNotification(t)}}))))}disableNotifications(){this.notificationListener.unsubscribe(),this.initialized=!1}showNotification(t){return Object(e.a)(this,void 0,void 0,(function*(){this.queue++,setTimeout(()=>Object(e.a)(this,void 0,void 0,(function*(){let i=[];t.icon&&i.push({side:"start",icon:t.icon,handler:()=>{}}),t.disableButton||i.push({side:"end",icon:s.a.Close,handler:()=>{}});const n=yield this.toastController.create({message:t.message,duration:t.time,buttons:i});n.onDidDismiss().then(t=>{this.queue--}),n.present()})),t.time*this.queue)}))}}return t.\u0275fac=function(i){return new(i||t)(c.Qb(r.L))},t.\u0275prov=c.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},SAsG:function(t,i,n){"use strict";n.d(i,"a",(function(){return j}));var e=n("mrSG"),o=n("nYR2"),s=n("HM5V"),c=n("fXoL"),r=n("TEn/"),a=n("H+bZ"),b=n("zzaN"),l=n("OC8m"),u=n("ofXK");function d(t,i){if(1&t&&(c.Mb(0,"div",16),c.Mb(1,"div",17),c.Ib(2,"img",18),c.Lb(),c.Lb()),2&t){const t=c.Wb().$implicit,i=c.Wb(2);c.xb(2),c.ac("src","./assets/cardSets/",i.cardSet,"/",t.cards[0],".png",c.fc)}}function h(t,i){1&t&&c.Ib(0,"ion-icon",19)}function f(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-chip",20),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit,n=c.Wb(2);return n.currentPlayer.isAdmin&&n.changeBalance(i)})),c.Ib(1,"ion-icon",21),c.Mb(2,"ion-label"),c.ic(3),c.Lb(),c.Lb()}if(2&t){const t=c.Wb().$implicit;c.xb(3),c.jc(t.balance)}}function p(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",22),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit;return c.Wb(2).remove(i)})),c.ic(1,"Rimuovi"),c.Lb()}}function m(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",22),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit;return c.Wb(2).setGhost(i,!0)})),c.ic(1,"Spettatore"),c.Lb()}}function g(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",22),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit;return c.Wb(2).setGhost(i,!1)})),c.ic(1,"Giocatore"),c.Lb()}}const y=function(t){return{canMove:t}},v=function(t){return{myself:t}};function L(t,i){if(1&t&&(c.Mb(0,"ion-item-sliding",9),c.Mb(1,"ion-item",10),c.Mb(2,"ion-label",9),c.ic(3),c.Lb(),c.hc(4,d,3,2,"div",11),c.hc(5,h,1,0,"ion-icon",12),c.hc(6,f,4,1,"ion-chip",13),c.Lb(),c.Mb(7,"ion-item-options",14),c.hc(8,p,2,0,"ion-item-option",15),c.hc(9,m,2,0,"ion-item-option",15),c.hc(10,g,2,0,"ion-item-option",15),c.Lb(),c.Lb()),2&t){const t=i.$implicit,n=c.Wb(2);c.Zb("ngClass",c.cc(10,y,t.canMove)),c.xb(1),c.Zb("disabled",t.ghost),c.xb(1),c.Zb("ngClass",c.cc(12,v,t.name==n.currentPlayer.name)),c.xb(1),c.jc(t.name),c.xb(1),c.Zb("ngIf",t.cards.length>0&&t.visible||n.status&&t.name==n.currentPlayer.name),c.xb(1),c.Zb("ngIf",t.isAdmin),c.xb(1),c.Zb("ngIf",n.moneyMode),c.xb(2),c.Zb("ngIf",n.currentPlayer.isAdmin&&n.currentPlayer.name!=t.name&&!n.status),c.xb(1),c.Zb("ngIf",n.currentPlayer.isAdmin&&!t.ghost&&!n.status),c.xb(1),c.Zb("ngIf",n.currentPlayer.isAdmin&&t.ghost&&!n.status)}}function M(t,i){if(1&t&&(c.Kb(0),c.hc(1,L,11,14,"ion-item-sliding",8),c.Jb()),2&t){const t=c.Wb();c.xb(1),c.Zb("ngForOf",t.players)}}function k(t,i){if(1&t&&(c.Mb(0,"div",16),c.Mb(1,"div",17),c.Ib(2,"img",18),c.Lb(),c.Lb()),2&t){const t=c.Wb().$implicit,i=c.Wb(2);c.xb(2),c.ac("src","./assets/cardSets/",i.cardSet,"/",t.cards[0],".png",c.fc)}}function x(t,i){1&t&&c.Ib(0,"ion-icon",19)}function I(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-chip",20),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit,n=c.Wb(2);return n.currentPlayer.isAdmin&&!n.status&&n.changeBalance(i)})),c.Ib(1,"ion-icon",21),c.Mb(2,"ion-label"),c.ic(3),c.Lb(),c.Lb()}if(2&t){const t=c.Wb().$implicit;c.xb(3),c.jc(t.balance)}}function C(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",22),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit;return c.Wb(2).remove(i)})),c.ic(1,"Rimuovi"),c.Lb()}}function P(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",22),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit;return c.Wb(2).setGhost(i,!0)})),c.ic(1,"Spettatore"),c.Lb()}}function O(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item-option",22),c.Ub("click",(function(){c.ec(t);const i=c.Wb().$implicit;return c.Wb(2).setGhost(i,!1)})),c.ic(1,"Giocatore"),c.Lb()}}function W(t,i){if(1&t&&(c.Mb(0,"ion-item-sliding",9),c.Mb(1,"ion-item",10),c.Mb(2,"ion-label",9),c.ic(3),c.Lb(),c.hc(4,k,3,2,"div",11),c.hc(5,x,1,0,"ion-icon",12),c.hc(6,I,4,1,"ion-chip",13),c.Ib(7,"ion-reorder",0),c.Lb(),c.Mb(8,"ion-item-options",14),c.hc(9,C,2,0,"ion-item-option",15),c.hc(10,P,2,0,"ion-item-option",15),c.hc(11,O,2,0,"ion-item-option",15),c.Lb(),c.Lb()),2&t){const t=i.$implicit,n=c.Wb(2);c.Zb("ngClass",c.cc(10,y,t.canMove)),c.xb(1),c.Zb("disabled",t.ghost),c.xb(1),c.Zb("ngClass",c.cc(12,v,t.name==n.currentPlayer.name)),c.xb(1),c.jc(t.name),c.xb(1),c.Zb("ngIf",t.cards.length>0&&t.visible||n.status&&t.name==n.currentPlayer.name),c.xb(1),c.Zb("ngIf",t.isAdmin),c.xb(1),c.Zb("ngIf",n.moneyMode),c.xb(3),c.Zb("ngIf",n.currentPlayer.isAdmin&&n.currentPlayer.name!=t.name&&!n.status),c.xb(1),c.Zb("ngIf",n.currentPlayer.isAdmin&&!t.ghost&&!n.status),c.xb(1),c.Zb("ngIf",n.currentPlayer.isAdmin&&t.ghost&&!n.status)}}function w(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-reorder-group",23),c.Ub("ionItemReorder",(function(i){return c.ec(t),c.Wb().reorderPlayers(i)})),c.hc(1,W,12,14,"ion-item-sliding",8),c.Lb()}if(2&t){const t=c.Wb();c.xb(1),c.Zb("ngForOf",t.players)}}function Z(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item",24),c.Ub("click",(function(){return c.ec(t),c.Wb().shareLink()})),c.Mb(1,"ion-label",25),c.ic(2,"Link di invito"),c.Lb(),c.Lb()}}function G(t,i){if(1&t){const t=c.Nb();c.Mb(0,"ion-item",26),c.Ub("click",(function(){return c.ec(t),c.Wb().shareLink()})),c.Mb(1,"ion-label",25),c.ic(2,"Link di invito"),c.Lb(),c.Lb()}}let j=(()=>{class t{constructor(t,i,n,e,o,s){this.modalController=t,this.navParams=i,this.api=n,this.clipboard=e,this.notificationService=o,this.alertController=s,this.players=[],this.reordering=!1,this.status=!0;const c=this.navParams.get("state"),r=this.navParams.get("nickname");c.subscribe(t=>{!this.reordering&&this.detectChange(this.players,t.players)&&(this.players=t.players,this.code=t.code,this.currentPlayer=t.players.find(t=>t.name===r),this.status=t.status,this.cardSet=t.cardSet,this.moneyMode=t.money)})}ngOnInit(){}dismiss(){this.modalController.dismiss()}reorderPlayers(t){this.reordering=!0;const i=this.players.splice(t.detail.from,1)[0];this.players.splice(t.detail.to,0,i),t.detail.complete(),this.api.updatePlayers(this.players,this.code).pipe(Object(o.a)(()=>this.reordering=!1)).subscribe()}detectChange(t,i){return t.forEach(t=>t.timestamp=void 0),i.forEach(t=>t.timestamp=void 0),JSON.stringify(t)!==JSON.stringify(i)}shareLink(){const t=this.api.clientEndpoint+"/join/"+this.code;this.clipboard.copy(t);const i=document.createElement("textarea");i.value=t,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),new s.b,this.notificationService.addNotification("Link copiato negli appunti")}remove(t){this.api.exitGroup(t.name,this.code).subscribe()}changeBalance(t){return Object(e.a)(this,void 0,void 0,(function*(){const i=yield this.alertController.create({header:"Cambio bilancio",inputs:[{name:"value",value:t.balance,type:"number",min:0}],buttons:[{text:"Annulla",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Conferma",handler:i=>{this.api.updateBalance(t.name,this.code,i.value).subscribe(t=>{})}}]});yield i.present()}))}setGhost(t,i){this.api.setGhost(t.name,this.code,i).subscribe(t=>{})}}return t.\u0275fac=function(i){return new(i||t)(c.Hb(r.F),c.Hb(r.G),c.Hb(a.a),c.Hb(b.a),c.Hb(l.a),c.Hb(r.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-players"]],decls:12,vars:4,consts:[["slot","end"],["color","dark",3,"click"],["name","close"],[1,"ion-padding-top"],[4,"ngIf"],["disabled","false",3,"ionItemReorder",4,"ngIf"],["class","ion-padding-top",3,"click",4,"ngIf"],["class","ion-padding-top","disabled","true",3,"click",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"player-container",3,"disabled"],["class","cards-container",4,"ngIf"],["name","albums-outline","class","rotate90",4,"ngIf"],["outline","",3,"click",4,"ngIf"],["side","end"],[3,"click",4,"ngIf"],[1,"cards-container"],[1,"card"],[3,"src"],["name","albums-outline",1,"rotate90"],["outline","",3,"click"],["name","server","color","warning"],[3,"click"],["disabled","false",3,"ionItemReorder"],[1,"ion-padding-top",3,"click"],["color","primary"],["disabled","true",1,"ion-padding-top",3,"click"]],template:function(t,i){1&t&&(c.Mb(0,"ion-header"),c.Mb(1,"ion-toolbar"),c.Mb(2,"ion-buttons",0),c.Mb(3,"ion-button",1),c.Ub("click",(function(){return i.dismiss()})),c.Ib(4,"ion-icon",2),c.Lb(),c.Lb(),c.Mb(5,"ion-title"),c.ic(6,"Giocatori online"),c.Lb(),c.Lb(),c.Lb(),c.Mb(7,"ion-content",3),c.hc(8,M,2,1,"ng-container",4),c.hc(9,w,2,1,"ion-reorder-group",5),c.hc(10,Z,3,0,"ion-item",6),c.hc(11,G,3,0,"ion-item",7),c.Lb()),2&t&&(c.xb(8),c.Zb("ngIf",!(i.currentPlayer.isAdmin&&i.players.length>1&&!i.status)),c.xb(1),c.Zb("ngIf",i.currentPlayer.isAdmin&&i.players.length>1&&!i.status),c.xb(1),c.Zb("ngIf",!i.status),c.xb(1),c.Zb("ngIf",i.status))},directives:[r.l,r.C,r.f,r.e,r.m,r.A,r.h,u.j,u.i,r.r,u.h,r.o,r.s,r.q,r.g,r.p,r.v,r.u],styles:[".player-container[_ngcontent-%COMP%]{--min-height:20vw!important}.cards-container[_ngcontent-%COMP%]{width:100%;height:18vw;position:absolute;bottom:0;padding:0;text-align:center}.canMove[_ngcontent-%COMP%]{--ion-background-color:#fff9f7;animation:fade 2s infinite;-moz-animation:fade 2s infinite;-webkit-animation:fade 2s infinite}@keyframes fade{0%{--ion-background-color:#fff4f0}50%{--ion-background-color:#fff}to{--ion-background-color:#fff4f0}}@-webkit-keyframes fade{0%{--ion-background-color:#fff4f0}50%{--ion-background-color:#fff}to{--ion-background-color:#fff4f0}}.card[_ngcontent-%COMP%]{height:25vw}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;border:.05px solid #d3d3d3;border-radius:1vw;filter:contrast(1.2)}.rotate90[_ngcontent-%COMP%]{transform:rotate(270deg)}.myself[_ngcontent-%COMP%]{font-weight:700}"]}),t})()}}]);
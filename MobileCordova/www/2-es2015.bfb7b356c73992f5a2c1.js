(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"H+bZ":function(t,e,i){"use strict";i.d(e,"a",(function(){return b}));var n=i("HDdC"),o=i("7o/Q");function s(t=-1){return e=>e.lift(new r(t,e))}class r{constructor(t,e){this.count=t,this.source=e}call(t,e){return e.subscribe(new c(t,this.count,this.source))}}class c extends o.a{constructor(t,e,i){super(t),this.count=e,this.source=i}error(t){if(!this.isStopped){const{source:e,count:i}=this;if(0===i)return super.error(t);i>-1&&(this.count=i-1),e.subscribe(this._unsubscribeAndRecycle())}}}var a=i("JIr8"),l=i("fXoL"),u=i("tk/3");let b=(()=>{class t{constructor(t){this.http=t,this.endpoint="http://2.238.108.96:3000",this.clientEndpoint="http://ammireto.cloud"}handleError(t){return t.error instanceof ErrorEvent?console.error("An error occurred:",t.error.message):console.error(`Backend returned code ${t.status}, body was: `+t.error),new n.a(t=>t.error("Something bad happened; please try again later."))}getCardSets(){return this.http.get(this.endpoint+"/getCardSets").pipe(s(2),Object(a.a)(this.handleError))}getGames(){return this.http.get(this.endpoint+"/getGames").pipe(s(2),Object(a.a)(this.handleError))}createGroup(t,e,i,n){return this.http.post(this.endpoint+"/createGroup",{nickname:t,cardSet:e,game:i,money:n}).pipe(s(2),Object(a.a)(this.handleError))}joinGroup(t,e){return this.http.get(this.endpoint+"/joinGroup/"+t+"/"+e).pipe(s(2),Object(a.a)(this.handleError))}exitGroup(t,e){return this.http.get(this.endpoint+"/exitGroup/"+t+"/"+e).pipe(s(2),Object(a.a)(this.handleError))}updatePlayers(t,e){return this.http.post(this.endpoint+"/updatePlayers",{players:t,code:e}).pipe(s(2),Object(a.a)(this.handleError))}updateBalance(t,e,i){return this.http.get(this.endpoint+"/updateBalance/"+t+"/"+e+"/"+i).pipe(s(2),Object(a.a)(this.handleError))}setGhost(t,e,i){return this.http.get(this.endpoint+"/setGhost/"+t+"/"+e+"/"+i).pipe(s(2),Object(a.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(u.a))},t.\u0275prov=l.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},HM5V:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));var n=function(t){return t.Close="close-outline",t.Login="log-in-outline",t.Logout="log-out-outline",t.Info="alert-circle-outline",t}({});class o{constructor(){this.disableButton=!1,this.time=2e3}}},OC8m:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("mrSG"),o=i("2Vo4"),s=i("HM5V"),r=i("fXoL"),c=i("TEn/");let a=(()=>{class t{constructor(t){this.toastController=t,this.notifications=[],this.notificationListener=new o.a(this.notifications),this.queue=-1,this.initialized=!1}ionViewDidLeave(){this.disableNotifications()}addNotification(t,e,i,n){const o=new s.b;o.message=t,o.icon=null!=e?e:o.icon,o.time=null!=i?i:o.time,o.disableButton=null!=n?n:o.disableButton,this.notifications.push(o),this.notificationListener.next(this.notifications)}enableNotifications(){this.initialized||(this.initialized=!0,this.notificationListener.subscribe(t=>Object(n.a)(this,void 0,void 0,(function*(){if(0!=t.length){const t=this.notifications.pop();this.notificationListener.next(this.notifications),yield this.showNotification(t)}}))))}disableNotifications(){this.notificationListener.unsubscribe(),this.initialized=!1}showNotification(t){return Object(n.a)(this,void 0,void 0,(function*(){this.queue++,setTimeout(()=>Object(n.a)(this,void 0,void 0,(function*(){let e=[];t.icon&&e.push({side:"start",icon:t.icon,handler:()=>{}}),t.disableButton||e.push({side:"end",icon:s.a.Close,handler:()=>{}});const i=yield this.toastController.create({message:t.message,duration:t.time,buttons:e});i.onDidDismiss().then(t=>{this.queue--}),i.present()})),t.time*this.queue)}))}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(c.L))},t.\u0275prov=r.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"ct+p":function(t,e,i){"use strict";i.r(e),i.d(e,"HomePageModule",(function(){return L}));var n=i("ofXK"),o=i("TEn/"),s=i("3Pt+"),r=i("tyNb"),c=i("mrSG"),a=i("HM5V"),l=i("fXoL"),u=i("H+bZ"),b=i("e8h1");let h=(()=>{class t{constructor(t){this.storage=t}setStorage(t,e){return Object(c.a)(this,void 0,void 0,(function*(){yield this.storage.set(t,e)}))}getStorage(t){return Object(c.a)(this,void 0,void 0,(function*(){return yield this.storage.get(t)}))}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(b.b))},t.\u0275prov=l.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=i("OC8m");function p(t,e){if(1&t&&(l.Mb(0,"ion-select-option",17),l.ic(1),l.Lb()),2&t){const t=e.$implicit;l.Zb("value",t.id),l.xb(1),l.jc(t.name)}}function f(t,e){if(1&t&&(l.Mb(0,"ion-select-option",17),l.ic(1),l.Lb()),2&t){const t=e.$implicit;l.Zb("value",t.id),l.xb(1),l.jc(t.name)}}const g=function(){return{standalone:!0}};function m(t,e){if(1&t){const t=l.Nb();l.Mb(0,"div",7),l.Mb(1,"ion-item"),l.Mb(2,"ion-label",8),l.ic(3,"Nickname"),l.Lb(),l.Mb(4,"ion-input",9),l.Ub("ngModelChange",(function(e){return l.ec(t),l.Wb().nickname=e})),l.Lb(),l.Lb(),l.Mb(5,"ion-list-header",10),l.Mb(6,"ion-label"),l.ic(7," Gruppo Esistente "),l.Lb(),l.Lb(),l.Mb(8,"ion-item"),l.Mb(9,"ion-label"),l.ic(10,"Codice"),l.Lb(),l.Mb(11,"ion-input",11),l.Ub("ngModelChange",(function(e){return l.ec(t),l.Wb().code=e})),l.Lb(),l.Lb(),l.Mb(12,"ion-button",12),l.Ub("click",(function(){return l.ec(t),l.Wb().join()})),l.ic(13,"Partecipa"),l.Lb(),l.Mb(14,"ion-list-header",10),l.Mb(15,"ion-label"),l.ic(16," Nuovo gruppo "),l.Lb(),l.Lb(),l.Mb(17,"ion-item"),l.Mb(18,"ion-label"),l.ic(19,"Set di carte"),l.Lb(),l.Mb(20,"ion-select",13),l.Ub("ngModelChange",(function(e){return l.ec(t),l.Wb().selectedSet=e})),l.hc(21,p,2,2,"ion-select-option",14),l.Lb(),l.Lb(),l.Mb(22,"ion-item"),l.Mb(23,"ion-label"),l.ic(24,"Gioco"),l.Lb(),l.Mb(25,"ion-select",13),l.Ub("ngModelChange",(function(e){return l.ec(t),l.Wb().selectedGame=e})),l.hc(26,f,2,2,"ion-select-option",14),l.Lb(),l.Lb(),l.Mb(27,"ion-item"),l.Mb(28,"ion-label"),l.ic(29,"Soldi"),l.Lb(),l.Mb(30,"ion-toggle",15),l.Ub("ngModelChange",(function(e){return l.ec(t),l.Wb().money=e})),l.Lb(),l.Lb(),l.Mb(31,"ion-button",16),l.Ub("click",(function(){return l.ec(t),l.Wb().create()})),l.ic(32,"Crea"),l.Lb(),l.Lb()}if(2&t){const t=l.Wb();l.xb(4),l.Zb("ngModel",t.nickname),l.xb(7),l.Zb("ngModel",t.code)("ngModelOptions",l.bc(10,g)),l.xb(9),l.Zb("ngModel",t.selectedSet)("ngModelOptions",l.bc(11,g)),l.xb(1),l.Zb("ngForOf",t.cardSets),l.xb(4),l.Zb("ngModel",t.selectedGame)("ngModelOptions",l.bc(12,g)),l.xb(1),l.Zb("ngForOf",t.games),l.xb(4),l.Zb("ngModel",t.money)}}function M(t,e){1&t&&(l.Mb(0,"div",7),l.Ib(1,"ion-icon",18),l.Lb())}const v=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o,s){this.alertController=t,this.route=e,this.router=i,this.api=n,this.utils=o,this.notificationService=s,this.money=!1,this.isOffline=!1}ionViewWillEnter(){this.loadData()}join(){this.code?this.nickname?this.retrieveGroup():this.presentAlert("Per favore, inserisci il nickname."):this.presentAlert("Per favore, inserisci il codice.")}create(){this.nickname?this.getCode():this.presentAlert("Per favore, inserisci il nickname.")}goToGame(t,e){this.saveData().then(i=>{const n={queryParams:{group:JSON.stringify(e),player:JSON.stringify(t),game:JSON.stringify(this.games.find(t=>t.id===e.game))},skipLocationChange:!0};this.router.navigate(["/game"],n)})}presentAlert(t){return Object(c.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({header:"Attenzione",message:t,buttons:["Ok"]});yield e.present()}))}saveData(){return Object(c.a)(this,void 0,void 0,(function*(){this.utils.setStorage("nickname",this.nickname)}))}loadData(){return Object(c.a)(this,void 0,void 0,(function*(){this.code=this.route.snapshot.paramMap.get("code"),this.utils.getStorage("nickname").then(t=>{this.nickname=t}),this.getCardSets(),this.getGames()}))}getCardSets(){this.api.getCardSets().subscribe(t=>{t.success&&t.data?(this.cardSets=t.data,this.selectedSet=this.cardSets[0].id):this.setOfflineStatus()},t=>{this.setOfflineStatus()})}getGames(){this.api.getGames().subscribe(t=>{t.success&&t.data?(this.games=t.data,this.selectedGame=this.games[0].id):this.setOfflineStatus()},t=>{this.setOfflineStatus()})}getCode(){this.api.createGroup(this.nickname,this.selectedSet,this.selectedGame,this.money).subscribe(t=>{if(t.success&&t.data){const e=t.data,i=t.data.players.find(t=>t.name===this.nickname);this.goToGame(i,e)}else this.presentAlert("Qualcosa non va, riprova pi\xf9 tardi.")})}retrieveGroup(){this.api.joinGroup(this.nickname,this.code).subscribe(t=>{if(t.success&&t.data){const e=t.data,i=t.data.players.find(t=>t.name===this.nickname);this.goToGame(i,e)}else this.presentAlert("Sembra che la partit\xe0 \xe8 gi\xe0 cominciata o che non esiste.")})}setOfflineStatus(){this.isOffline=!0,this.notificationService.enableNotifications(),this.notificationService.addNotification("Ops, il server non risponde",a.a.Info,5e3)}setOnlineStatus(){this.isOffline=!1,this.notificationService.disableNotifications()}}return t.\u0275fac=function(e){return new(e||t)(l.Hb(o.a),l.Hb(r.a),l.Hb(r.g),l.Hb(u.a),l.Hb(h),l.Hb(d.a))},t.\u0275cmp=l.Bb({type:t,selectors:[["app-home"]],decls:19,vars:4,consts:[[3,"translucent"],["color","warning"],["color","danger"],[3,"fullscreen"],["collapse","condense"],["size","large"],["id","container",4,"ngIf"],["id","container"],["position","floating"],["type","text","required","",3,"ngModel","ngModelChange"],["lines","full"],["type","text","required","","placeholder","Inserisci il codice",3,"ngModel","ngModelOptions","ngModelChange"],["color","success",3,"click"],["required","","cancelText","Annulla","okText","Ok",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["slot","end","color","warning",3,"ngModel","ngModelChange"],["color","warning",3,"click"],[3,"value"],["name","cloud-offline-outline",2,"zoom","4.0"]],template:function(t,e){1&t&&(l.Mb(0,"ion-header",0),l.Mb(1,"ion-toolbar"),l.Mb(2,"ion-title"),l.ic(3," un"),l.Mb(4,"ion-text",1),l.ic(5,"ti"),l.Lb(),l.Mb(6,"ion-text",2),l.ic(7,"vitti"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.Mb(8,"ion-content",3),l.Mb(9,"ion-header",4),l.Mb(10,"ion-toolbar"),l.Mb(11,"ion-title",5),l.ic(12," un"),l.Mb(13,"ion-text",1),l.ic(14,"ti"),l.Lb(),l.Mb(15,"ion-text",2),l.ic(16,"vitti"),l.Lb(),l.Lb(),l.Lb(),l.Lb(),l.hc(17,m,33,13,"div",6),l.hc(18,M,2,0,"div",6),l.Lb()),2&t&&(l.Zb("translucent",!0),l.xb(8),l.Zb("fullscreen",!0),l.xb(9),l.Zb("ngIf",!e.isOffline),l.xb(1),l.Zb("ngIf",e.isOffline))},directives:[o.l,o.C,o.A,o.z,o.h,n.j,o.o,o.s,o.n,o.K,s.f,s.d,s.e,o.t,o.e,o.x,o.J,n.i,o.B,o.b,o.y,o.m],styles:["#container[_ngcontent-%COMP%]{text-align:center;padding-top:15vw}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]}),t})()}];let O=(()=>{class t{}return t.\u0275mod=l.Fb({type:t}),t.\u0275inj=l.Eb({factory:function(e){return new(e||t)},imports:[[r.i.forChild(v)],r.i]}),t})(),L=(()=>{class t{}return t.\u0275mod=l.Fb({type:t}),t.\u0275inj=l.Eb({factory:function(e){return new(e||t)},imports:[[n.b,s.a,o.D,O]]}),t})()}}]);